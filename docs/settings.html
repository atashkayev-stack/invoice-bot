<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil-Einstellungen</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: Arial; padding: 20px; background: #f4f4f9; }
        input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px; }
        button { width: 100%; padding: 15px; background: #0088cc; color: white; border: none; border-radius: 5px; cursor: pointer; }
        label { font-weight: bold; font-size: 0.9em; }
    </style>
</head>
<body>
    <h3>Mein Profil (Verkäufer)</h3>
    <label>Firma</label>
    <input type="text" id="company_name" placeholder="Firma GmbH">
    <label>Straße</label>
    <input type="text" id="street" placeholder="Hauptstr. 1">
    <label>Stadt</label>
    <input type="text" id="city" placeholder="Berlin">
    <label>PLZ</label>
    <input type="text" id="postal_code" placeholder="10115">
    <label>IBAN</label>
    <input type="text" id="iban" placeholder="DE12 3456...">
    
    <button onclick="saveProfile()">Speichern</button>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // Автозаполнение из URL
        const params = new URLSearchParams(window.location.search);
        const encoded = params.get('data');
        if (encoded) {
            try {
                const data = JSON.parse(atob(decodeURIComponent(encoded)));
                document.getElementById('company_name').value = data.company_name || '';
                document.getElementById('street').value = data.street || '';
                document.getElementById('city').value = data.city || '';
                document.getElementById('postal_code').value = data.postal_code || '';
                document.getElementById('iban').value = data.iban || '';
            } catch (e) { console.error(e); }
        }

        function saveProfile() {
            const data = {
                company_name: document.getElementById('company_name').value,
                street: document.getElementById('street').value,
                city: document.getElementById('city').value,
                postal_code: document.getElementById('postal_code').value,
                iban: document.getElementById('iban').value
            };
            tg.sendData(JSON.stringify(data));
        }
    </script>
</body>
</html>